# 备份恢复功能修改说明

## 修改内容概述

本次修改主要针对数据库备份和恢复功能进行了优化和修复，包括路径配置改进和功能验证测试。

## 修改的文件列表

### 1. 核心功能修改
- **src/database/database.cpp** - 修改了数据库文件存储路径配置
  - 将数据库文件从项目外的 `../../database/` 改为项目内的 `./database/`
  - 确保所有数据库文件和备份文件都存储在项目目录内便于管理

### 2. 测试程序
- **sql_based_backup_restore_test.cpp** - 基于SQL脚本的备份恢复测试
  - 模拟了完整的数据库结构创建、备份、恢复流程
  - 验证了路径修改后的功能正确性

- **simple_backup_restore_test.cpp** - 简单备份恢复测试
  - 用于快速验证备份恢复功能

- **show_database_content.cpp** - 数据库内容查看工具
  - 用于验证恢复后的数据完整性

## 功能改进

1. **路径配置优化**
   - 数据库文件集中存储在项目内的 `./database/` 目录
   - 备份文件也存储在同一目录下，格式为 `./database/backup_<dbname>_<timestamp>/`
   - 解决了文件分散在项目外导致的管理不便问题

2. **功能验证**
   - 完成了完整的备份恢复测试流程
   - 验证了数据库结构和表数据的正确恢复
   - 确保备份恢复功能的可靠性

## 使用说明

1. **编译核心库**：
   ```bash
   cd build
   mingw32-make -j8
   ```

2. **运行测试**：
   ```bash
   ./sql_based_backup_restore_test.exe
   ```

3. **查看恢复结果**：
   ```bash
   ./show_database_content.exe
   ```

## 注意事项

- 所有数据库文件现在都存储在项目内的 `database/` 目录
- 备份文件会自动生成在该目录下，以 `backup_` 开头的子目录
- 建议定期清理旧的备份文件以节省空间